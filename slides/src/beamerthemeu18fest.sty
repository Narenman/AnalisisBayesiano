\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerthemeu18fest}

\mode<presentation>

\RequirePackage{tikz}
\RequirePackage{fontspec}
\RequirePackage{polyglossia}
\RequirePackage{tcolorbox}

% \setsansfont[Ligatures=TeX]{PT Sans}
\setmainfont[Ligatures=TeX]{IBM Plex Sans}
\setsansfont[Ligatures=TeX]{IBM Plex Sans}
\setmonofont[Ligatures=TeX, BoldFont={IBM Plex Mono Medium}, ItalicFont={IBM Plex Mono Light Italic}]{IBM Plex Mono Light}
\setdefaultlanguage{spanish}
\tcbset{boxsep=1mm, colback=white, colbacktitle=violet!50!white, colframe=violet!50!white}

\DeclareOptionBeamer{presnum}{\def\beamer@X@presnum{#1}}
\ExecuteOptionsBeamer{presnum=}
\ProcessOptionsBeamer

\usefonttheme{professionalfonts}
\usefonttheme[onlymath]{serif}

\setbeamertemplate{itemize item}[square]
\setbeamertemplate{itemize subitem}[triangle]

\setbeamercolor*{frametitle}{fg=violet, bg=violet!40!white}
\setbeamercolor*{date in header/foot}{fg=gray}
\setbeamercolor*{itemize item}{fg=violet}
\setbeamercolor*{itemize subitem}{fg=violet}
\setbeamercolor*{presnum}{fg=violet!36!white}

\setbeamerfont*{title}{size=\huge, shape=\bfseries}
\setbeamerfont*{subtitle}{size=\normalsize, shape=\itshape}
\setbeamerfont*{institute}{size=\normalsize}
\setbeamerfont*{date}{size=\normalsize}
\setbeamerfont*{frametitle}{size=\Large}
\setbeamerfont*{presnum}{size=\Huge, shape=\bfseries}

\defbeamertemplate*{frametitle}{plain}{%
  \ifnum\value{framenumber}>0%
  \vspace{-1pt}%
  \begin{beamercolorbox}[wd=\paperwidth, leftskip=0.2cm, rightskip=0.2cm, sep=0.2cm]{frametitle}%
    \strut\insertframetitle\strut%
  \end{beamercolorbox}
  \fi%
}

\defbeamertemplate*{footline}{plain}{%
  \ifnum\insertpagenumber=1%
  \begin{beamercolorbox}[wd=\paperwidth, sep=0.3cm]{date in header/foot}
    \hfill\usebeamerfont{date in header/foot}{23--26 de septiembre de 2019\makebox[0.1cm]{}}
  \end{beamercolorbox}
  \else
  \begin{beamercolorbox}[wd=\paperwidth, sep=0.3cm]{date in header/foot}
    \hfill\usebeamerfont{date in header/foot}{%
      \makebox[0.3cm]{\hfill\insertframenumber}\makebox[0.1cm]{}%
    }
  \end{beamercolorbox}
  \fi
}

\defbeamertemplate*{title page}{plain}{%
  {%
    \usebeamercolor{frametitle}\colorlet{tsbg}{bg}
    \begin{tikzpicture}[overlay, remember picture]
      \fill[color=tsbg] (current page.north west) rectangle ([shift = {(0, -0.6\paperheight)}] current page.north east);
      \node [anchor=south east, shift={(0, 0.4\paperheight)}, inner sep=0] at (current page.south east) {%
        \usebeamerfont{presnum}
        \usebeamercolor[fg]{presnum}
        \fontsize{100}{100}\selectfont
        \beamer@X@presnum%
        };
    \end{tikzpicture}
  }%
  %
  \ifx\insertsubtitle\@empty%
  {%
    \vspace{-\baselineskip}
    \begin{minipage}[b][0.6\paperheight]{\textwidth}
      \usebeamerfont{title}%
      \usebeamercolor[fg]{frametitle}%
      \inserttitle
      \vspace{2.5\baselineskip}
    \end{minipage}
  }%
  \else {%
    \vspace{-2\baselineskip}
    \begin{minipage}[b][0.2\paperheight]{\textwidth}
      \vspace{\baselineskip}%
      \usebeamerfont{subtitle}%
      \usebeamercolor[fg]{frametitle}%
      \insertsubtitle
    \end{minipage}
    %
    \begin{minipage}[b][0.4\paperheight]{\textwidth}
      \usebeamerfont{title}%
      \usebeamercolor[fg]{frametitle}%
      \inserttitle
      \vspace{\baselineskip}
    \end{minipage}
  } \fi
  
  \vspace{\baselineskip}
  
  \begin{minipage}[t]{\textwidth}
    \usebeamerfont{author}
    \insertauthor
  \end{minipage}
    
  \begin{minipage}[t]{\textwidth}
    \usebeamerfont{institute}
    \insertinstitute
  \end{minipage}
    
  \begin{minipage}[t]{\textwidth}
    \usebeamerfont{date}
    \insertdate
  \end{minipage}

  \vspace*{0pt plus 100fill}
}

\setbeamertemplate{navigation symbols}{}

\mode<all>